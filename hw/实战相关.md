## 如果攻击的回显有延迟或者说攻击生效需要一定的时间 ， 那该怎么通过流量分析判断出攻击是否生效了？

1. 检查数据包，如果有明显的内容异常，如某个端口流量突然增加，可能是攻击生效的表现。

2. 分析日志文件：攻击可能会在系统日志中留下痕迹，例如异常日志、错误日志等，通过分析日志文件可以确定攻击是否生效。以下是实现步骤：

   ```txt
   在Linux上，常见的监控日志包括系统日志（syslog）、安全日志（secure）、应用程序日志等。可以使用以下命令：
   
   查看系统日志（syslog）：使用命令 tail -f /var/log/syslog 可以实时查看系统日志。
   
   查看安全日志（secure）：使用命令 tail -f /var/log/secure 可以实时查看安全日志。
   
   查看应用程序日志：不同的应用程序可能会有不同的日志路径和格式。一般可以在应用程序的配置文件中查看日志路径，例如Apache的日志路径为 /var/log/httpd/。
   
   在Windows上，常见的监控日志包括事件日志、安全日志、应用程序日志等。查询这些日志可以使用以下步骤：
   
   打开事件查看器：在Windows系统中，可以通过“开始菜单”中的“运行”选项或按下Win+R键，输入eventvwr.msc打开事件查看器。
   
   选择要查看的日志类型：在事件查看器中，可以选择查看“Windows 日志”下的不同类型日志，如“应用程序”、“安全”、“系统”等。
   
   过滤日志内容：在事件查看器中，可以使用“筛选器”来过滤日志内容，以便查找特定事件。
   
   总之，无论是在Linux还是Windows系统中，查看监控日志都是非常重要的安全措施。通过查看监控日志，可以及时发现异常事件，及时采取措施保护系统安全。
   ```

   

   ## 应急响应排查思路

   ###### Linux应急响应
   
   ###### 系统账号
   
   查看/etc/passwd文件,是否有可疑的账户
   
   lastb命令可以查看登陆失败的用户信息
   
   last命令查看用户的登录信息
   
   ###### 启动项
   
   检查启动项中是否存在异常任务,Linux的启动项在/etc/rc.rocal文件和/etc/rc.d/目录下
   
   ###### 进程
   
   ps -aux查看进程信息,检查是否存在恶意进程
   
   -a    显示所有进程
   -u    显示用户名
   -x    显示完整信息
   网络连接
   
   netstat -antlp查看网络连接,检查是否存在可疑的网络连接
   
   -a    显示所有选项
   -n    显示数字信息
   -t    显示tcp连接
   -l    显示监听状态的链接
   -p    显示相关的程序名
   分析文件
   
   检查近期创建或修改的文件,分析可疑的文件
   
   find / -mtime -1        根目录范围下,搜索1天内修改过的文件
   
   /        查找的范围(路径)
   -ctime    按照文件创建时间搜索(-n指n天内,+n指n天前)
   -mtime    根据文件更改时间搜索(-n指n天内,+n指n天前)
   -atime    根据文件访问时间搜索(-n指n天内,+n指n天前)
   -perm    根据权限查找    find -perm 777
   ###### Windows应急响应
   系统账号
   
   net user    -- 查看系统账号
   
   启动项
   
   win+r打开运行窗口,输入shell:startup,检查开机启动项
   
   计划任务
   
   cmd输入taskschd.msc,检查计划任务,或者schtasks命令查看计划任务
   
   进程
   
   tasklist    -- 查看进程
   
   taskkill    -- 结束进程
   
   netstat -ano    -- 查看网络连接
   
   -a        显示所有端口
   -n        数字形式显示
   -o        显示关联的进程ID
   
   shift粘滞键后门
   
   按下5次shift键,检查弹出来的是不是系统的粘滞键
   
   
   
   ## 一台主机在内网进行横向攻击，你应该怎么做？

1. 隔离受感染主机：立即隔离受感染的主机，以避免攻击扩散和影响更多的主机。

   ```
   发现受感染的主机可以采取以下方法：
   
   监控网络流量：使用网络流量分析工具，对内网的网络流量进行监控，特别关注异常流量或连接，以及高流量主机。
   
   检测漏洞：使用漏洞扫描工具或安全漏洞扫描器，对内网主机进行漏洞检测，找到存在漏洞的主机，并及时修复漏洞。
   
   端口扫描：使用端口扫描工具，对内网主机进行端口扫描，发现未授权的服务或服务漏洞，特别是常见的攻击端口。
   
   日志分析：对网络设备、服务器等进行日志分析，特别是包括主机登录、文件访问、服务开启等，发现异常活动或痕迹。
   
   主机安全软件：在主机上安装安全软件，如杀毒软件、入侵检测系统等，通过实时监控主机的行为和活动，发现异常进程和连接。
   ```

2. 收集攻击信息：记录攻击者的IP地址、攻击方式、攻击时间等信息，以便后续分析和取证。

   ```
   网络流量分析：通过网络流量分析工具，对攻击流量进行分析，找到攻击者的IP地址、攻击目标等信息。
   
   邮件头分析：如果攻击者使用了钓鱼邮件等方式进行攻击，可以通过查看邮件头信息，获取攻击者的IP地址、发送邮件的时间等信息。
   
   恶意文件分析：如果攻击者通过发送恶意文件进行攻击，可以对恶意文件进行分析，找到攻击者的IP地址、攻击方式、攻击时间等信息。
   
   系统日志：通过系统日志分析工具，对受攻击主机的系统日志进行分析，查找攻击者的IP地址、攻击方式、攻击时间等信息。
   
   安全设备日志：通过分析安全设备的日志，如入侵检测系统、安全事件管理系统等，获取攻击者的IP地址、攻击方式、攻击时间等信息。
   ```

3. 恢复被攻击主机：对受感染主机进行杀毒、修复漏洞或重装系统等操作，以避免攻击继续发展。

4. 加固安全措施：分析攻击原因，加强安全防护措施，如加强访问控制、更新补丁、加强入侵检测等。

5. 限制网络流量：通过流量分析工具或防火墙等工具，限制异常网络流量和连接，以减轻攻击带来的影响。

   ```
   启用入侵检测系统（IDS）和入侵防御系统（IPS）：IDS和IPS可以监测网络流量和连接，并根据预设规则进行异常流量和连接的阻止和防御，可以使用以下工具启用IDS和IPS：
   Suricata：是一个开源的网络入侵检测和预防系统（NIDS/NIPS），支持多线程和多核CPU，并能够解析多种协议。
   启动Suricata服务：启动suricata服务，使用以下命令：
   sudo suricata -c /etc/suricata/suricata.yaml -i eth0
   
   其中，-c选项指定suricata配置文件路径，-i选项指定要监测的网卡接口。
   ```

6. 进行安全审计：对受攻击的系统进行安全审计和日志分析，以发现其他潜在的安全风险或入侵痕迹。
