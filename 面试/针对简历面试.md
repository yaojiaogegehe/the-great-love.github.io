# 运维

## Windows

### Windows进程和服务排查

cmd命令用systeminfo简单了解查看系统信息，Windows2003就用winmsd，Windows2010及以上就用msinfo32，在里面单击【软件环境】中的【正在运行任务】，可以查看正在运行任务的名称、状态、路径。当然也可以通过powershell的get-process命令来查看。

比如我发现typora这个软件进程有异常，中止异常进程可以通过下面的命令：

```powershell
stop-process -name typora
```

获取该进程详细信息可用下面命令，依旧以typora为例：

```powershell
Get-Process -name typora | Format-List 
```

同时msinfo32中也可以查看【服务】、【系统驱动程序】、【加载的模块】、【启动程序】这些模块的信息

也可以用工具，我是使用processhack进行排查

### 用户信息排查

#### 当前用户查看

cmd中使用

```cmd
net user
```

#### 排查克隆账户

查看用户，对于一些隐藏用户，可以通过regedit打开注册表编辑器中【HKEY_LOCAL_MACHINE】下的【SAM】选项，通过右键更改权限进入底层的Users文件夹，通过对照names文件夹里面是否两个不同账号拥有相同的“F值”，或者对照F值和上面users文件夹中二进制数据是否一样也行。

#### 查弱口令/可疑账号

win+r输入lusrmgr.msc查看当前用户，如有异常用户就禁用或删除，也可以通过控制面板的用户账户界面进行管理

#### 使用工具排查

用D盾去扫描

### Windows启动项排查

win+r输入msconfig进入系统配置实用程序中的启动选项查看。

### 任务计划

win+r输入taskschd.msc打开查看

### 文件痕迹检查

#### 敏感目录

各个盘下的/temp、/tmp文件夹

例如c:\windows\system32\inetsrv\MetaBase.xml #IIS配置文件

还有就是MySQL，PHP，Apache等等的配置文件，这里不在过多阐述和总结。

网上有很多现成又详细的总结，大家可自行查阅。

#### 下载文件

包括但不仅限于：浏览器历史记录、下载文件、cookie信息

#### 查看用户Recent文件

访问过的文件夹或文件是有记录的如C:/Documents and Settings\Default User\Recent

C:/Documents and Settings\用户名\Recent

#### 查看预读取文件

Win+R输入【%SystemRoot%\Prefetch】即可发现pf预读取文件

#### 时间点查找

可列出攻击日期内新增的文件，从而发现相关的恶意软件。

```cmd
forfiles /m *.zip /d +2022/5/30 /s /p c:\ /c "cmd /c echo @path @fdate @ftime" 2>null
```

### 威胁情报

ip和域名网上多查查，

遇见可疑文件有事儿没事儿了多找几个地方上传一下。 

### 流量分析

Wireshark是很棒的分析工具，1、要会抓包 2、要会分析（善用过滤器）简单分享几个我用的比较多的。

```
ip.addr == ip    #过滤特定ip
ip.src == ip     #过滤源ip
ip.dst == ip     #过滤目的ip
http、https、smtp、arp等协议直接输入即可筛选
top.sort == 端口号 #对端口号进行过滤
tcp contains xxx   #在数据包中筛查某一关键字
arp.opcode==2     #过滤ARP应答帧
arp.opcode==1     #过滤ARP请求帧
http.response==1 && http.response.code==200 #响应请求成功的包
tcp.flags.ack==1&&tcp.flags.syn==1   #抓握手包
```

## Linux

应急响应主要分为这4个环节：识别现象 > 清除病毒 > 闭环兜底 > 系统加固





